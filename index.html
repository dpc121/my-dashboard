<!DOCTYPE html>
<html lang="hi">
<head>
<meta charset="UTF-8">
<title>Secure Website Dashboard</title>
<meta name="viewport" content="width=device-width, initial-scale=1.0">

<link rel="manifest" href="manifest.json">
<meta name="theme-color" content="#020617">

<style>
body{
  margin:0;
  font-family:Arial,Helvetica,sans-serif;
  background:#0f172a;
  color:#e5e7eb;
}
.container{max-width:1000px;margin:auto;padding:15px}
.card{
  background:#020617;
  padding:15px;
  border-radius:10px;
  margin-bottom:15px;
  box-shadow:0 0 10px rgba(0,0,0,.6);
}
h2,h3{margin:10px 0}
input,select,button{
  padding:8px;
  margin:4px;
  border-radius:6px;
  border:none;
}
input,select{
  background:#020617;
  color:#fff;
  border:1px solid #334155;
}
button{
  background:#2563eb;
  color:#fff;
  font-weight:bold;
  cursor:pointer;
}
button:hover{background:#1d4ed8}
table{
  width:100%;
  border-collapse:collapse;
  margin-top:10px;
}
th,td{
  border:1px solid #334155;
  padding:8px;
  text-align:center;
  vertical-align:top;
}
th{background:#020617}
.copy{cursor:pointer;color:#38bdf8}
.small{font-size:12px;color:#94a3b8}
.hide{display:none}
.btn-sm{padding:5px 8px;font-size:12px;margin:2px}
.red{background:#dc2626}
.gray{background:#475569}
.green{background:#16a34a}
</style>
</head>

<body>
<div class="container">

<!-- LOGIN -->
<div class="card" id="loginBox">
  <h2>üîê Admin Login</h2>
  <input id="luser" placeholder="Username">
  <input id="lpass" type="password" placeholder="Password">
  <label class="small">
    <input type="checkbox" id="rememberMe"> Remember Me (30 Days)
  </label>
  <br>
  <button onclick="login()">Login / Register</button>
</div>

<!-- DASHBOARD -->
<div class="card hide" id="dash">
  <h2>üìå Personal Website Manager</h2>

  <div class="card">
    <h3>‚ûï New Website Add</h3>
    <input id="site" placeholder="Website Name">
    <input id="url" placeholder="Website URL">
    <input id="uid" placeholder="User ID">
    <input id="pwd" placeholder="Password">
    <select id="cat">
      <option>Govt</option>
      <option>Private</option>
      <option>Bank</option>
      <option>Other</option>
    </select>
    <br>
    <button onclick="addSite()">Save</button>
  </div>

  <input placeholder="üîç Search Website" onkeyup="search(this.value)">

  <table id="tbl"></table>

  <button class="red" onclick="logout()">Logout</button>
</div>

</div>

<script>
/* ===== Encryption ===== */
function enc(t){return btoa(unescape(encodeURIComponent(t)))}
function dec(t){return decodeURIComponent(escape(atob(t)))}

let currentUser=null;
let sites=[];

/* ===== Auto Login ===== */
window.onload=function(){
  let u=localStorage.getItem("rememberUser");
  let t=localStorage.getItem("rememberTime");
  if(u && t){
    let d=(Date.now()-t)/(1000*60*60*24);
    if(d<=30){
      currentUser=u;
      sites=JSON.parse(localStorage.getItem("sites_"+u)||"[]");
      loginBox.classList.add("hide");
      dash.classList.remove("hide");
      render();
    }
  }
};

/* ===== Login ===== */
function login(){
  let u=luser.value.trim(), p=lpass.value.trim();
  if(!u||!p) return alert("Username & Password likhiye");

  let users=JSON.parse(localStorage.getItem("users")||"{}");
  if(!users[u]){
    users[u]=enc(p);
    localStorage.setItem("users",JSON.stringify(users));
  }
  if(dec(users[u])!==p) return alert("Wrong Password");

  currentUser=u;
  sites=JSON.parse(localStorage.getItem("sites_"+u)||"[]");

  if(rememberMe.checked){
    localStorage.setItem("rememberUser",u);
    localStorage.setItem("rememberTime",Date.now());
  }

  loginBox.classList.add("hide");
  dash.classList.remove("hide");
  render();
}

/* ===== Logout ===== */
function logout(){
  localStorage.removeItem("rememberUser");
  localStorage.removeItem("rememberTime");
  currentUser=null;
  dash.classList.add("hide");
  loginBox.classList.remove("hide");
}

/* ===== Add ===== */
function addSite(){
  sites.push({
    site:site.value,
    url:url.value,
    uid:enc(uid.value),
    pwd:enc(pwd.value),
    cat:cat.value
  });
  save(); render();
  site.value=url.value=uid.value=pwd.value="";
}

function save(){
  localStorage.setItem("sites_"+currentUser,JSON.stringify(sites));
}

/* ===== Delete ===== */
function del(i){
  if(confirm("Delete kare?")){
    sites.splice(i,1);
    save(); render();
  }
}

/* ===== Search ===== */
function search(v){
  v=v.toLowerCase();
  [...tbl.rows].forEach((r,i)=>{
    if(i===0)return;
    r.style.display=r.innerText.toLowerCase().includes(v)?"":"none";
  });
}

/* ===== Copy ===== */
function autoCopy(t){
  navigator.clipboard.writeText(t);
  alert("Copied ‚úî");
}

/* ===== Show / Hide ===== */
function togglePwd(i){
  let f=document.getElementById("pwd_"+i);
  f.type = f.type==="password"?"text":"password";
}

/* ===== Edit ===== */
function editPwd(i){
  let n=prompt("New Password dijiye:");
  if(!n) return;
  sites[i].pwd=enc(n);
  save(); render();
}

/* ===== Render ===== */
function render(){
  tbl.innerHTML=`
  <tr>
    <th>Website</th>
    <th>Open</th>
    <th>ID</th>
    <th>Password</th>
    <th>Category</th>
    <th>Action</th>
  </tr>`;

  sites.forEach((d,i)=>{
    tbl.innerHTML+=`
    <tr>
      <td>${d.site}</td>
      <td><a href="${d.url}" target="_blank">Open</a></td>
      <td class="copy" onclick="autoCopy('${dec(d.uid)}')">${dec(d.uid)}</td>
      <td>
        <input id="pwd_${i}" type="password" value="${dec(d.pwd)}" readonly><br>
        <button class="btn-sm gray" onclick="togglePwd(${i})">Show</button>
        <button class="btn-sm green" onclick="editPwd(${i})">Edit</button>
        <button class="btn-sm" onclick="autoCopy('${dec(d.pwd)}')">Copy</button>
      </td>
      <td>${d.cat}</td>
      <td><button class="btn-sm red" onclick="del(${i})">‚ùå</button></td>
    </tr>`;
  });
}

/* ===== PWA ===== */
if("serviceWorker" in navigator){
  navigator.serviceWorker.register("service-worker.js");
}
</script>

</body>
</html>
